<!DOCTYPE html>
<html>
  <head>
    <title>Online JWT tool</title>
    <meta charset="utf-8">
    <link rel="stylesheet" href="css/main.css">

    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description" content="An online tool to perform JWT verification, decoding, or generation. RSA keys and algorithms only." />
  </head>

  <!-- ======================================================= -->
  <body>
    <div class='container'>
      <div class='banner'>
        <h2>JWT Decoder, Verifier, Generator, Decryptor</h2>
        <div>For information on JWT see <a href='https://tools.ietf.org/html/rfc7519'>IETF RFC 7519</a>.</div>
        <div class="alert alert-warning alert-dismissible fade" role="alert" id="mainalert"></div>
        <div id='buildversion'>version <span id='version_id'>??</span></div>
      </div>

      <div class='panel-group'>
        <div class='panel panel-left' id='panel_encoded'>
          <p>Encoded Token <span class='length'></span>
            <button type="button" class="btn btn-outline-secondary btn-md btn-copy" data-target="encodedjwt" title='copy to clipboard'>
              <span class="oi oi-clipboard"></span>
            </button>
          </p>
          <textarea rows=12 cols=34 id='encodedjwt' class='rawvalue'></textarea>
        </div>

        <div class='panel panel-center' id='panel_buttons'>
          <select class="form-control form-control-sm sel-variant" id='sel-variant'>
            <option value='Signed'>Signed</option>
            <option value='Encrypted'>Encrypted</option>
          </select>
          <select class="form-control form-control-sm sel-alg" id='sel-alg'>
            <!-- options will be dynamically added -->
          </select>
          <button type="button" class="btn btn-outline-secondary btn-lg btn-encode" title='encode and sign a JWT'>
            <span class="oi oi-arrow-thick-left"></span>
          </button>
          <button type="button" class="btn btn-outline-secondary btn-lg btn-decode" title='decode a JWT'>
            <span class="oi oi-arrow-thick-right"></span>
          </button>
          <button type="button" class="btn btn-outline-secondary btn-lg btn-verify" title='verify the encoded JWT with the given public key'>
            <span class="oi oi-check"></span>
          </button>
          <button type="button" class="btn btn-outline-secondary btn-lg btn-regen" title='generate a new header and payload'>
            <span class="oi oi-reload"></span>
          </button>
          <button type="button" class="btn btn-outline-secondary btn-lg btn-newkeypair" title='generate a new keypair'>
            <span class="oi oi-key"></span>
            <!-- <span style='display: block;'>new</span>  -->
          </button>
          <div style='font-size:60%; margin-top:20px;'
               title='these apply only when generating JWT'>overrides:</div>
          <div style='font-size:60%; margin-bottom:6px;'>exp:</div>
          <select class="form-control form-control-sm sel-expiry" id='sel-expiry' title='override expiry; used only when encoding and signing.' style='margin-top:6px;'>
            <option value='do nothing'>do nothing</option>
            <option value='no expiry'>no expiry</option>
            <option value='10 seconds'>10 seconds</option>
            <option value='60 seconds'>60 seconds</option>
            <option value='5 minutes'>5 minutes</option>
            <option value='30 minutes'>30 minutes</option>
          </select>
          <span style='font-size:60%; margin-right:6px;'>iat:</span>
          <input id='chk-iat' type='checkbox' />
        </div>

        <div class='panel panel-right clearfix' id='panel_decoded'>
          <div id='header'>
            <p>Decoded Header <span class='length'></span>
              <button type="button" title="copy to clipboard" class="btn btn-outline-secondary btn-md btn-copy"
                      data-target="token-decoded-header" title="copy to clipboard">
                <span class="oi oi-clipboard"></span>
              </button>
            </p>
            <textarea rows=12 cols=34 id='token-decoded-header' class='jwt-header'></textarea>
          </div>
          <div id='payload'>
            <p>Decoded Payload <span class='length'></span>
              <button type="button" title="copy to clipboard" class="btn btn-outline-secondary btn-md btn-copy"
                      data-target="token-decoded-payload" title="copy to clipboard">
                <span class="oi oi-clipboard"></span>
              </button>
            </p>
            <textarea rows=12 cols=34 id='token-decoded-payload' class='jwt-payload'></textarea>
          </div>
          <div id='privatekey' title='paste in your private key, it does not leave your browser'>
            <p>Private Key
              <button type="button" title="copy to clipboard" class="btn btn-outline-secondary btn-md btn-copy"
                      data-target="ta_privatekey" title="copy to clipboard">
                <span class="oi oi-clipboard"></span>
              </button>
            </p>
            <textarea rows=12 cols=34 id='ta_privatekey'></textarea>
          </div>
          <div id='publickey'>
            <p><span id='publickey-label'>Public Key (PEM or JWKS)</span>
              <button type="button" title="copy to clipboard" class="btn btn-outline-secondary btn-md btn-copy"
                      data-target="ta_publickey" title="copy to clipboard">
                <span class="oi oi-clipboard"></span>
              </button>
            </p>
            <textarea rows=12 cols=34 id='ta_publickey'></textarea>
          </div>
          <div id='symmetrickey'>
            <p>Symmetric Key <span class='length'></span>
              <button type="button" title="copy to clipboard" class="btn btn-outline-secondary btn-md btn-copy"
                      data-target="ta_symmetrickey" title="copy to clipboard">
                <span class="oi oi-clipboard"></span>
              </button>
            </p>
            <input type='text' id='ta_symmetrickey' value='Secret123!'>
            <div>
              <span>Key Encoding:</span>
              <select class="form-control form-control-sm sel-symkey-coding">
                <option value='UTF-8'>UTF-8</option>
                <option value='Hex'>Hex</option>
                <option value='Base64'>Base64</option>
                <option value='PBKDF2'>PBKDF2</option>
              </select>
            </div>
            <div id='pbkdf2_params'>
            <div>
              <span>iterations:</span>
              <input type='number' id='ta_pbkdf2_iterations' value='10000'>
            </div>
            <div>
              <span>salt:</span>
              <input type='text' id='ta_pbkdf2_salt' value='abcdefg'>
            </div>
            <div>
              <span>salt encoding:</span>
              <select class="form-control form-control-sm sel-symkey-pbkdf2-salt-coding">
                <option value='UTF-8'>UTF-8</option>
                <option value='Hex'>Hex</option>
                <option value='Base64'>Base64</option>
              </select>
            </div>
            </div>
          </div>
        </div>
      </div>

      <div class='footer'>
        <div>Notes</div>
        <ol>
          <li>This tool uses EcmaScript v9, and webcrypto; it will run only on modern, current browsers.</li>
          <li>For generating and verifying signed JWT, this page supports RSA, HMAC, or ECDSA algorithms. For generating or verifying encrypted JWT, it supports RSA keys and RSA-OAEP-256, as well as PBES2 algorithms. For details on algorithms, see <a href='https://tools.ietf.org/html/rfc7518'>the JWA specification</a>.</li>
          <li>to use this, first select the variant of JWT: either Signed or Encrypted. Then select the algorithm.</li>
          <li><p style='margin-bottom:0;'>Signed JWT</p>
            <ol type='a'>
              <li>decode: paste in the signed JWT in the box on the left-hand side. The header and payload will automatically be decoded and displayed in the appropriate boxes. </li>
              <li>verify: after pasting in the signed JWT, also specify your key: if using an asymmetric algorithm, paste in your <a href='https://tools.ietf.org/html/rfc7468#section-13'>PEM-formatted public key</a> into the box labeled "Public Key". Or paste a JWKS into that box. Or, if you're using a symmetric algorithm, specify the symmetric key.
                Finally, and click the verify button (with a checkmark icon).</li>
              <li>create: select set the payload and the header in the boxes on the right hand side, and paste in your key: either a <a href='https://tools.ietf.org/html/rfc7468#section-10'>PEM-formatted (PKCS#8) private key</a> for asymmetric algorithms, or the symmetric key for symmetric algorithms. Then, click the encode button (leftward pointing arrow).</li>
            </ol>
          </li>
          <li><p style='margin-bottom:0;'>Encrypted JWT</p>
            <ol type='a'>
              <li>decode: paste in the encrypted JWT in the box on the left-hand side. The header will be decoded and displayed in the appropriate box. The payload is encrypted, so it cannot be decoded without the private key.</li>
              <li>decrypt and verify: after pasting in the encrypted JWT, if you are using an RSA algorithm, paste in your <a href='https://tools.ietf.org/html/rfc7468#section-10'>PEM-formatted (PKCS#8) private key</a>. If using PBES2, key in your password and the salt and iteration count.  The keys and passwords never leave your browser. Then click the verify button (the button with the checkmark icon).</li>
              <li>create: set the payload and the header in the boxes on the right hand side. If you're using an asymmetric algorithm, paste in your <a href='https://tools.ietf.org/html/rfc7468#section-13'>PEM-formatted public key</a> into the box labeled "Public Key", or paste a JWKS into that box. (With this second option you need to specify a <tt>kid</tt> or <tt>x5t</tt> field in the JWT header). If you're using a symmetric algorithm, specify the password-based key parameters. Then, click the encode button (with the left-pointing arrow).</li>
            </ol>
          <li>On initial page load, the browser will generate a new RSA keypair and insert it into the appropriate boxes, and then generate a contrived JWT. You can replace either or both with your own values.</li>
          <li>You can generate a new asymmetric keypair by clicking the key button.</li>
          <li>When specifying the symmetric key, you need at least 32 bytes of key material for HS256, 48 for HS384, and 64 for HS512, whether signing or verifying. The <a href='https://en.wikipedia.org/wiki/PBKDF2'>PBKDF2</a> will generate keys of the appropriate size. If you choose a different coding system, you need to ensure minimum key size yourself. </li>
          <li>Information that you paste here, including JWT and keys, whether secret, private or public, never leaves your browser. Information from the decoding or decrypting also stays in the browser. Nothing gets posted to a server. Still, you should take care not to use this site for private information. </li>
          <li>Ths page shows the header and payload "pretty-printed". The actual header and payload in a JWT do not have newlines.</li>
          <li>There's a shortcut: if you open the url with <tt>&lt;baseurl&gt;?JWT_HERE</tt>, it will decode *that* JWT.   It
            might save you the step of pasting in your encoded JWT, if you open this page from a program. If you're paranoid you can also use
            the # as a separator. </li>
        </ol>
      </div>

      <div class='footer'>
        <div>Credits</div>
        <p>
          This page uses the <a href='https://github.com/cisco/node-jose'>node-jose</a> library for JWT decoding, verification, and generation, online, in the browser page. It also uses <a href='https://codemirror.net/doc/manual.html'>CodeMirror</a> for the interactive editors, <a href='https://getbootstrap.com/docs/4.0'>Bootstrap 4.0</a> for styling, the <a href='https://useiconic.com/open/'>Open Iconic fonts</a> for button symbols, and <a href='https://jquery.com/'>jQuery</a> for interactivity. </p>

        <p>The code for this page is <a href='https://github.com/DinoChiesa/jwt-webtool'>here</a>. You can download it, fork it, or submit issues via that link.</p>

      </div>

    </div>
    <script src="js/main.js" charset="utf-8"></script>
  </body>

</html>
